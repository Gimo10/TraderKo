<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FX Trader Pro - Enhanced Trading Journal</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --primary-light: #818cf8;
            --profit: #10b981;
            --profit-light: #d1fae5;
            --loss: #ef4444;
            --loss-light: #fee2e2;
            --bg: #f1f5f9;
            --card: #ffffff;
            --text: #1e293b;
            --text-light: #64748b;
            --gold: #f59e0b;
            --gold-light: #fef3c7;
            --crypto: #7c3aed;
            --crypto-light: #ede9fe;
            --border: #e2e8f0;
            --shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            max-width: 1200px;
            margin: 0 auto;
            padding: 0;
            line-height: 1.6;
        }
        
        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            padding: 20px;
            border-radius: 0 0 16px 16px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            color: white;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header-title {
            font-weight: 700;
            font-size: 1.6rem;
            display: flex;
            align-items: center;
            gap: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header-title i {
            font-size: 1.8rem;
        }
        
        .header-info {
            text-align: right;
        }
        
        .header-tagline {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
        }
        
        .header-author {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.9rem;
        }
        
        /* Tab Navigation */
        .tabs {
            margin-bottom: 30px;
        }
        
        .tab-list {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            background-color: var(--card);
            border-radius: 12px;
            padding: 5px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }
        
        .tab-button {
            background: transparent;
            border: none;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .tab-button.active {
            background-color: var(--primary);
            color: white;
        }
        
        .tab-button:hover:not(.active) {
            background-color: var(--border);
        }
        
        .tab-button i {
            font-size: 1.1rem;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Card Styles */
        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            margin-bottom: 20px;
        }
        
        .card-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
        }
        
        .card-title i {
            font-size: 1.2rem;
            background: var(--primary-light);
            color: white;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.03);
            border: 1px solid var(--border);
        }
        
        .stat-card-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .stat-info {
            display: flex;
            flex-direction: column;
        }
        
        .stat-label {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .win-rate .stat-value {
            color: var(--profit);
        }
        
        .loss-rate .stat-value {
            color: var(--loss);
        }
        
        .total-trades .stat-value {
            color: var(--primary);
        }
        
        .net-pl .stat-value.positive {
            color: var(--profit);
        }
        
        .net-pl .stat-value.negative {
            color: var(--loss);
        }
        
        .stat-icon {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .win-rate .stat-icon {
            background-color: var(--profit-light);
            color: var(--profit);
        }
        
        .loss-rate .stat-icon {
            background-color: var(--loss-light);
            color: var(--loss);
        }
        
        .total-trades .stat-icon {
            background-color: var(--primary-light);
            color: white;
        }
        
        .net-pl .stat-icon.positive {
            background-color: var(--profit-light);
            color: var(--profit);
        }
        
        .net-pl .stat-icon.negative {
            background-color: var(--loss-light);
            color: var(--loss);
        }
        
        /* Button Styles */
        .button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .button:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.2);
        }
        
        .button-success {
            background: var(--profit);
        }
        
        .button-success:hover {
            background: #0d9488;
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.2);
        }
        
        .button-danger {
            background: var(--loss);
        }
        
        .button-danger:hover {
            background: #dc2626;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.2);
        }
        
        .button-outline {
            background: transparent;
            color: var(--text);
            border: 1px solid var(--border);
        }
        
        .button-outline:hover {
            background: var(--bg);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text);
        }
        
        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 0.95rem;
            transition: all 0.2s;
            color: var(--text);
            background: white;
        }
        
        input:focus, select:focus {
            border-color: var(--primary-light);
            outline: none;
            box-shadow: 0 0 0 3px rgba(129, 140, 248, 0.2);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        /* Range Slider */
        .range-slider {
            width: 100%;
            margin-top: 10px;
        }
        
        .range-slider-value {
            display: inline-block;
            position: relative;
            width: 60px;
            color: var(--text);
            text-align: center;
            border-radius: 3px;
            background: var(--bg);
            padding: 5px 10px;
            margin-left: 10px;
        }
        
        /* Table Styles */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            text-align: left;
            padding: 12px 15px;
            border-bottom: 2px solid var(--border);
            color: var(--text-light);
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid var(--border);
            vertical-align: middle;
        }
        
        tr:hover {
            background-color: rgba(0, 0, 0, 0.02);
        }
        
        /* Badge Styles */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .badge-forex {
            background-color: var(--primary-light);
            color: white;
        }
        
        .badge-gold {
            background-color: var(--gold-light);
            color: var(--gold);
        }
        
        .badge-crypto {
            background-color: var(--crypto-light);
            color: var(--crypto);
        }
        
        .badge-buy {
            background-color: var(--profit-light);
            color: var(--profit);
        }
        
        .badge-sell {
            background-color: var(--loss-light);
            color: var(--loss);
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            position: relative;
            animation: modalFadeIn 0.3s ease-out;
            border: 1px solid var(--border);
        }
        
        @keyframes modalFadeIn {
            from { 
                opacity: 0;
                transform: translateY(-20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .modal-title {
            margin-top: 0;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.5rem;
            font-weight: 700;
            border-bottom: 2px solid var(--border);
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        
        .modal-title i {
            background: var(--primary-light);
            color: white;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            font-size: 1.2rem;
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--bg);
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text-light);
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }
        
        .modal-close:hover {
            background: var(--loss-light);
            color: var(--loss);
            transform: rotate(90deg);
        }
        
        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }
        
        /* Pair Suggestions */
        .pair-suggestions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }
        
        .pair-suggestion {
            background: var(--bg);
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s;
            border: 1px solid var(--border);
        }
        
        .pair-suggestion:hover {
            background: var(--primary-light);
            color: white;
            transform: translateY(-2px);
        }
        
        .pair-suggestion.gold {
            background: var(--gold-light);
            color: var(--gold);
            border-color: var(--gold-light);
        }
        
        .pair-suggestion.gold:hover {
            background: var(--gold);
            color: white;
            border-color: var(--gold);
        }
        
        .pair-suggestion.crypto {
            background: var(--crypto-light);
            color: var(--crypto);
            border-color: var(--crypto-light);
        }
        
        .pair-suggestion.crypto:hover {
            background: var(--crypto);
            color: white;
            border-color: var(--crypto);
        }
        
        /* Calculator Result */
        .calculator-result {
            margin-top: 20px;
            padding: 20px;
            background: #f0f9ff;
            border-radius: 12px;
            border-left: 5px solid var(--primary);
            display: none;
        }
        
        .result-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }
        
        .result-row:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 600;
            color: var(--text-light);
        }
        
        .result-value {
            font-weight: 700;
            color: var(--primary);
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--border);
        }
        
        .empty-state-text {
            margin-bottom: 20px;
        }
        
        /* Market Data */
        .market-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
        }
        
        .market-tab {
            background: transparent;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
        }
        
        .market-tab.active {
            background-color: var(--primary);
            color: white;
        }
        
        .market-tab:hover:not(.active) {
            background-color: var(--border);
        }
        
        .market-content {
            display: none;
        }
        
        .market-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        
        .market-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .market-refresh {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .market-last-updated {
            font-size: 0.8rem;
            color: var(--text-light);
        }
        
        .change-positive {
            color: var(--profit);
        }
        
        .change-negative {
            color: var(--loss);
        }
        
        /* Trading Stats */
        .stats-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
        }
        
        .stats-tab {
            background: transparent;
            border: none;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-light);
            transition: all 0.3s;
        }
        
        .stats-tab.active {
            background-color: var(--primary);
            color: white;
        }
        
        .stats-tab:hover:not(.active) {
            background-color: var(--border);
        }
        
        .stats-content {
            display: none;
        }
        
        .stats-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }
        
        .stats-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .stats-timeframe {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stats-timeframe select {
            width: auto;
            padding: 8px 12px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        .stats-section {
            background: var(--card);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.03);
            border: 1px solid var(--border);
        }
        
        .stats-section-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text);
            border-bottom: 1px solid var(--border);
            padding-bottom: 10px;
        }
        
        .stats-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid var(--border);
        }
        
        .stats-item:last-child {
            border-bottom: none;
        }
        
        .stats-item-label {
            color: var(--text-light);
            font-weight: 500;
        }
        
        .stats-item-value {
            font-weight: 600;
        }
        
        /* Responsive Styles */
        @media (max-width: 1024px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .header-info {
                text-align: center;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .button-group {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 640px) {
            .tab-button span {
                display: none;
            }
            
            .tab-button i {
                font-size: 1.3rem;
            }
            
            .card {
                padding: 15px;
            }
            
            .stats-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-container">
            <div class="header-title">
                <i class="fas fa-chart-line"></i> FX Trader Pro
            </div>
            <div class="header-info">
                <div class="header-tagline">Smart Lot Calculator & Trade Journal</div>
                <div class="header-author">Moan Wyeth T. Frejas</div>
            </div>
        </div>
    </header>
    
    <div class="container" style="padding: 0 20px;">
        <!-- Tab Navigation -->
        <div class="tabs">
            <div class="tab-list">
                <button class="tab-button active" data-tab="journal">
                    <i class="fas fa-book"></i>
                    <span>Journal</span>
                </button>
                <button class="tab-button" data-tab="calculator">
                    <i class="fas fa-calculator"></i>
                    <span>Calculator</span>
                </button>
                <button class="tab-button" data-tab="stats">
                    <i class="fas fa-chart-bar"></i>
                    <span>Statistics</span>
                </button>
                <button class="tab-button" data-tab="market">
                    <i class="fas fa-chart-line"></i>
                    <span>Market</span>
                </button>
            </div>
            
            <!-- Journal Tab -->
            <div class="tab-content active" id="journal-tab">
                <div class="card">
                    <div class="section-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <div class="card-title">
                            <i class="fas fa-book"></i> Trade Journal
                        </div>
                        <button class="button" onclick="showRecordTradeModal()">
                            <i class="fas fa-plus"></i> Record Trade
                        </button>
                    </div>
                    
                    <!-- Trade Stats -->
                    <div class="stats-grid">
                        <div class="stat-card win-rate">
                            <div class="stat-card-content">
                                <div class="stat-info">
                                    <div class="stat-label">Win Rate</div>
                                    <div class="stat-value" id="winRate">0%</div>
                                </div>
                                <div class="stat-icon">
                                    <i class="fas fa-arrow-trend-up"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card loss-rate">
                            <div class="stat-card-content">
                                <div class="stat-info">
                                    <div class="stat-label">Loss Rate</div>
                                    <div class="stat-value" id="lossRate">0%</div>
                                </div>
                                <div class="stat-icon">
                                    <i class="fas fa-arrow-trend-down"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card total-trades">
                            <div class="stat-card-content">
                                <div class="stat-info">
                                    <div class="stat-label">Total Trades</div>
                                    <div class="stat-value" id="totalTrades">0</div>
                                </div>
                                <div class="stat-icon">
                                    <i class="fas fa-chart-bar"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card net-pl">
                            <div class="stat-card-content">
                                <div class="stat-info">
                                    <div class="stat-label">Net P/L</div>
                                    <div class="stat-value" id="netPL">$0.00</div>
                                </div>
                                <div class="stat-icon" id="netPLIcon">
                                    <i class="fas fa-dollar-sign"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Trade History -->
                    <div class="table-container">
                        <table id="tradeHistoryTable">
                            <thead>
                                <tr>
                                    <th>Date</th>
                                    <th>Pair</th>
                                    <th>Direction</th>
                                    <th>Entry</th>
                                    <th>Exit</th>
                                    <th>Lots</th>
                                    <th>Pips</th>
                                    <th>P/L</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="tradeHistoryBody">
                                <!-- Trade rows will be added here -->
                            </tbody>
                        </table>
                        
                        <div id="emptyTradeHistory" class="empty-state">
                            <i class="fas fa-book"></i>
                            <div class="empty-state-text">No trades recorded yet.</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Calculator Tab -->
            <div class="tab-content" id="calculator-tab">
                <div class="card">
                    <div class="card-title">
                        <i class="fas fa-calculator"></i> Lot Size Calculator
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div>
                            <div class="form-group">
                                <label for="accountCurrency">Account Currency</label>
                                <select id="accountCurrency">
                                    <option value="USD">USD</option>
                                    <option value="EUR">EUR</option>
                                    <option value="GBP">GBP</option>
                                    <option value="JPY">JPY</option>
                                    <option value="AUD">AUD</option>
                                    <option value="CAD">CAD</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="pair">Trading Pair</label>
                                <select id="pair">
                                    <option value="EUR/USD">EUR/USD</option>
                                    <option value="GBP/USD">GBP/USD</option>
                                    <option value="USD/JPY">USD/JPY</option>
                                    <option value="AUD/USD">AUD/USD</option>
                                    <option value="USD/CAD">USD/CAD</option>
                                    <option value="XAU/USD">XAU/USD (Gold)</option>
                                    <option value="BTC/USD">BTC/USD</option>
                                    <option value="ETH/USD">ETH/USD</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="accountBalance">Account Balance</label>
                                <input type="number" id="accountBalance" placeholder="e.g., 1000">
                            </div>
                            
                            <div class="form-group">
                                <label for="riskPercentage">Risk Percentage: <span id="riskPercentageValue">1</span>%</label>
                                <input type="range" id="riskPercentage" min="0.1" max="5" step="0.1" value="1" class="range-slider">
                            </div>
                            
                            <div class="form-group">
                                <label for="stopLossPips">Stop Loss (Pips)</label>
                                <input type="number" id="stopLossPips" placeholder="e.g., 30">
                            </div>
                            
                            <button class="button" onclick="calculateLotSize()">
                                <i class="fas fa-calculator"></i> Calculate Lot Size
                            </button>
                        </div>
                        
                        <div>
                            <div id="calculatorResult" class="calculator-result">
                                <div class="result-row">
                                    <span class="result-label">Risk Amount:</span>
                                    <span class="result-value" id="riskAmountResult">$0.00</span>
                                </div>
                                <div class="result-row">
                                    <span class="result-label">Recommended Lot Size:</span>
                                    <span class="result-value" id="lotSizeResult">0.00</span>
                                </div>
                                <div class="result-row">
                                    <span class="result-label">Micro Lots (0.01):</span>
                                    <span class="result-value" id="microLotsResult">0.00</span>
                                </div>
                                <div class="result-row">
                                    <span class="result-label">Pip Value (0.01 lot):</span>
                                    <span class="result-value" id="pipValueResult">$0.00 per pip</span>
                                </div>
                            </div>
                            
                            <div style="margin-top: 30px;">
                                <h3 style="font-size: 1.2rem; font-weight: 600; margin-bottom: 15px;">Position Sizing Tips</h3>
                                <ul style="list-style-type: disc; padding-left: 20px; color: var(--text-light);">
                                    <li style="margin-bottom: 8px;">Never risk more than 1-2% of your account on a single trade</li>
                                    <li style="margin-bottom: 8px;">Consider reducing position size during volatile market conditions</li>
                                    <li style="margin-bottom: 8px;">For beginners, start with smaller position sizes (0.5% risk or less)</li>
                                    <li style="margin-bottom: 8px;">Adjust your stop loss based on market volatility and support/resistance levels</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Statistics Tab -->
            <div class="tab-content" id="stats-tab">
                <div class="card">
                    <div class="stats-header">
                        <div class="card-title">
                            <i class="fas fa-chart-bar"></i> Trading Statistics
                        </div>
                        <div class="stats-timeframe">
                            <span>Timeframe:</span>
                            <select id="statsTimeframe" onchange="updateStatistics()">
                                <option value="all">All Time</option>
                                <option value="week">Last Week</option>
                                <option value="month">Last Month</option>
                                <option value="year">Last Year</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="stats-tabs">
                        <button class="stats-tab active" data-stats-tab="pairs">Pairs Performance</button>
                        <button class="stats-tab" data-stats-tab="profit">Profit Analysis</button>
                    </div>
                    
                    <div class="stats-content active" id="pairs-stats">
                        <div class="table-container">
                            <table id="pairsStatsTable">
                                <thead>
                                    <tr>
                                        <th>Pair</th>
                                        <th>Total Trades</th>
                                        <th>Win Rate</th>
                                        <th>Net P/L</th>
                                    </tr>
                                </thead>
                                <tbody id="pairsStatsBody">
                                    <!-- Pair stats rows will be added here -->
                                </tbody>
                            </table>
                            
                            <div id="emptyPairsStats" class="empty-state">
                                <i class="fas fa-chart-pie"></i>
                                <div class="empty-state-text">No trading data available.</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats-content" id="profit-stats">
                        <div class="stats-grid">
                            <div class="stats-section">
                                <div class="stats-section-title">Profit Breakdown</div>
                                <div class="stats-item">
                                    <div class="stats-item-label">Total Profit:</div>
                                    <div class="stats-item-value" id="totalProfit" style="color: var(--profit);">$0.00</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-item-label">Total Loss:</div>
                                    <div class="stats-item-value" id="totalLoss" style="color: var(--loss);">$0.00</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-item-label">Net Profit/Loss:</div>
                                    <div class="stats-item-value" id="netProfit">$0.00</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-item-label">Profit Factor:</div>
                                    <div class="stats-item-value" id="profitFactor" style="color: var(--primary);">N/A</div>
                                </div>
                            </div>
                            
                            <div class="stats-section">
                                <div class="stats-section-title">Trade Statistics</div>
                                <div class="stats-item">
                                    <div class="stats-item-label">Average Win:</div>
                                    <div class="stats-item-value" id="avgWin" style="color: var(--profit);">$0.00</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-item-label">Average Loss:</div>
                                    <div class="stats-item-value" id="avgLoss" style="color: var(--loss);">$0.00</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-item-label">Largest Win:</div>
                                    <div class="stats-item-value" id="largestWin" style="color: var(--profit);">$0.00</div>
                                </div>
                                <div class="stats-item">
                                    <div class="stats-item-label">Largest Loss:</div>
                                    <div class="stats-item-value" id="largestLoss" style="color: var(--loss);">$0.00</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Market Tab -->
            <div class="tab-content" id="market-tab">
                <div class="card">
                    <div class="market-header">
                        <div class="card-title">
                            <i class="fas fa-chart-line"></i> Market Overview
                        </div>
                        <div class="market-refresh">
                            <span class="market-last-updated" id="marketLastUpdated">Last updated: Never</span>
                            <button class="button button-outline" onclick="refreshMarketData()" id="refreshButton">
                                <i class="fas fa-sync-alt"></i> Refresh
                            </button>
                        </div>
                    </div>
                    
                    <div class="market-tabs">
                        <button class="market-tab active" data-market-tab="forex">Forex</button>
                        <button class="market-tab" data-market-tab="gold">Gold</button>
                        <button class="market-tab" data-market-tab="crypto">Crypto</button>
                    </div>
                    
                    <div class="market-content active" id="forex-market">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Symbol</th>
                                        <th>Bid</th>
                                        <th>Ask</th>
                                        <th>Change</th>
                                        <th>High</th>
                                        <th>Low</th>
                                    </tr>
                                </thead>
                                <tbody id="forexMarketBody">
                                    <!-- Forex market data will be added here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="market-content" id="gold-market">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Symbol</th>
                                        <th>Bid</th>
                                        <th>Ask</th>
                                        <th>Change</th>
                                        <th>High</th>
                                        <th>Low</th>
                                    </tr>
                                </thead>
                                <tbody id="goldMarketBody">
                                    <!-- Gold market data will be added here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="market-content" id="crypto-market">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Symbol</th>
                                        <th>Bid</th>
                                        <th>Ask</th>
                                        <th>Change</th>
                                        <th>High</th>
                                        <th>Low</th>
                                    </tr>
                                </thead>
                                <tbody id="cryptoMarketBody">
                                    <!-- Crypto market data will be added here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Record Trade Modal -->
    <div id="recordTradeModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="hideRecordTradeModal()">&times;</button>
            <h2 class="modal-title"><i class="fas fa-plus-circle"></i> Record Trade</h2>
            
            <div class="form-group">
                <label for="modalTradePair">Trading Pair</label>
                <select id="modalTradePair">
                    <option value="">Select trading pair</option>
                    <option value="EUR/USD">EUR/USD</option>
                    <option value="GBP/USD">GBP/USD</option>
                    <option value="USD/JPY">USD/JPY</option>
                    <option value="AUD/USD">AUD/USD</option>
                    <option value="USD/CAD">USD/CAD</option>
                    <option value="XAU/USD">XAU/USD (Gold)</option>
                    <option value="BTC/USD">BTC/USD</option>
                    <option value="ETH/USD">ETH/USD</option>
                    <option value="custom">Custom Pair</option>
                </select>
            </div>
            
            <div id="customPairGroup" class="form-group" style="display: none;">
                <label for="customPair">Custom Pair</label>
                <input type="text" id="customPair" placeholder="e.g. EUR/GBP">
            </div>
            
            <div class="form-group">
                <label>Direction</label>
                <div style="display: flex; gap: 20px; margin-top: 10px;">
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="radio" name="tradeDirection" value="buy" checked>
                        <span>Buy</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                        <input type="radio" name="tradeDirection" value="sell">
                        <span>Sell</span>
                    </label>
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="modalEntryPrice">Entry Price</label>
                    <input type="number" id="modalEntryPrice" step="0.00001" placeholder="1.0850">
                </div>
                <div class="form-group">
                    <label for="modalExitPrice">Exit Price</label>
                    <input type="number" id="modalExitPrice" step="0.00001" placeholder="1.0900">
                </div>
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="modalTradeLotSize">Lot Size</label>
                    <input type="number" id="modalTradeLotSize" step="0.01" placeholder="0.10">
                </div>
                <div class="form-group">
                    <label for="modalTradeCurrency">Account Currency</label>
                    <select id="modalTradeCurrency">
                        <option value="USD">USD</option>
                        <option value="EUR">EUR</option>
                        <option value="GBP">GBP</option>
                        <option value="JPY">JPY</option>
                        <option value="AUD">AUD</option>
                        <option value="CAD">CAD</option>
                    </select>
                </div>
            </div>
            
            <div class="button-group">
                <button onclick="recordTrade('win')" class="button button-success">
                    <i class="fas fa-check-circle"></i> Win
                </button>
                <button onclick="recordTrade('loss')" class="button button-danger">
                    <i class="fas fa-times-circle"></i> Loss
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Global variables
        let trades = JSON.parse(localStorage.getItem('trades')) || [];
        let marketData = [];
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Set up tab navigation
            setupTabs();
            
            // Set up market tabs
            setupMarketTabs();
            
            // Set up stats tabs
            setupStatsTabs();
            
            // Initialize risk percentage slider
            const riskSlider = document.getElementById('riskPercentage');
            const riskValue = document.getElementById('riskPercentageValue');
            
            riskSlider.addEventListener('input', function() {
                riskValue.textContent = this.value;
            });
            
            // Set up custom pair toggle
            const modalTradePair = document.getElementById('modalTradePair');
            const customPairGroup = document.getElementById('customPairGroup');
            
            modalTradePair.addEventListener('change', function() {
                if (this.value === 'custom') {
                    customPairGroup.style.display = 'block';
                } else {
                    customPairGroup.style.display = 'none';
                }
            });
            
            // Load trades and update UI
            updateTradeHistory();
            updateStatistics();
            
            // Load market data
            loadMarketData();
            
            // Close modals when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    event.target.style.display = 'none';
                }
            });
        });
        
        // Set up tab navigation
        function setupTabs() {
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.getAttribute('data-tab');
                    
                    // Remove active class from all buttons and contents
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    tabContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked button and corresponding content
                    button.classList.add('active');
                    document.getElementById(`${tabName}-tab`).classList.add('active');
                });
            });
        }
        
        // Set up market tabs
        function setupMarketTabs() {
            const marketTabs = document.querySelectorAll('.market-tab');
            const marketContents = document.querySelectorAll('.market-content');
            
            marketTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-market-tab');
                    
                    // Remove active class from all tabs and contents
                    marketTabs.forEach(t => t.classList.remove('active'));
                    marketContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked tab and corresponding content
                    tab.classList.add('active');
                    document.getElementById(`${tabName}-market`).classList.add('active');
                });
            });
        }
        
        // Set up stats tabs
        function setupStatsTabs() {
            const statsTabs = document.querySelectorAll('.stats-tab');
            const statsContents = document.querySelectorAll('.stats-content');
            
            statsTabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const tabName = tab.getAttribute('data-stats-tab');
                    
                    // Remove active class from all tabs and contents
                    statsTabs.forEach(t => t.classList.remove('active'));
                    statsContents.forEach(content => content.classList.remove('active'));
                    
                    // Add active class to clicked tab and corresponding content
                    tab.classList.add('active');
                    document.getElementById(`${tabName}-stats`).classList.add('active');
                });
            });
        }
        
        // Show record trade modal
        function showRecordTradeModal() {
            document.getElementById('recordTradeModal').style.display = 'flex';
        }
        
        // Hide record trade modal
        function hideRecordTradeModal() {
            document.getElementById('recordTradeModal').style.display = 'none';
            
            // Reset form
            document.getElementById('modalTradePair').value = '';
            document.getElementById('customPair').value = '';
            document.getElementById('modalEntryPrice').value = '';
            document.getElementById('modalExitPrice').value = '';
            document.getElementById('modalTradeLotSize').value = '';
            document.querySelector('input[name="tradeDirection"][value="buy"]').checked = true;
            document.getElementById('customPairGroup').style.display = 'none';
        }
        
        // Calculate pip value based on pair type
        function calculatePipValue(pair, accountCurrency) {
            pair = pair.toUpperCase();
            
            // Gold (XAU/USD)
            if (pair === "XAU/USD") {
                // For gold, 1 pip is typically $0.01 for 1 lot (100oz)
                return 1; // $1 per pip for 1 standard lot (100oz)
            }
            
            // Crypto (BTC/USD, ETH/USD)
            if (pair === "BTC/USD" || pair === "ETH/USD") {
                // For crypto, pip value varies more, but we'll use $1 per pip for 1 BTC/ETH
                return 1; // $1 per pip for 1 BTC/ETH
            }
            
            // Forex pairs
            const baseCurrency = pair.split('/')[0];
            const quoteCurrency = pair.split('/')[1];
            
            // For JPY pairs
            if (quoteCurrency === "JPY") {
                return 1000; // Approx 1000 JPY per pip for 1 lot
            }
            
            // Standard forex pairs (EUR/USD, GBP/USD, etc.)
            if (quoteCurrency === accountCurrency) {
                return 10; // $10 per pip for 1 lot
            }
            
            // For other cases (needs more complex calculation with exchange rates)
            return 10; // Default to $10 per pip for 1 lot
        }
        
        // Calculate lot size
        function calculateLotSize() {
            // Get inputs
            const accountCurrency = document.getElementById("accountCurrency").value;
            const pair = document.getElementById("pair").value;
            const accountBalance = parseFloat(document.getElementById("accountBalance").value);
            const riskPercentage = parseFloat(document.getElementById("riskPercentage").value);
            const stopLossPips = parseFloat(document.getElementById("stopLossPips").value);
            
            // Validate inputs
            if (!accountBalance || !riskPercentage || !stopLossPips) {
                alert("Please fill in all required fields!");
                return;
            }
            
            // Calculate risk amount
            const riskAmount = (accountBalance * riskPercentage) / 100;
            
            // Get pip value based on pair type
            const pipValue = calculatePipValue(pair, accountCurrency);
            
            // Calculate lot size
            let lotSize;
            
            if (pair === "XAU/USD") {
                // For gold, standard lot is 100oz
                lotSize = riskAmount / (stopLossPips * pipValue);
            } else if (pair === "BTC/USD" || pair === "ETH/USD") {
                // For crypto, standard lot is 1 BTC/ETH
                lotSize = riskAmount / (stopLossPips * pipValue);
            } else {
                // For forex, standard lot is 100,000 units
                lotSize = riskAmount / (stopLossPips * (pipValue / 100));
            }
            
            // Display result
            const resultDiv = document.getElementById("calculatorResult");
            resultDiv.style.display = "block";
            
            document.getElementById("riskAmountResult").textContent = `${accountCurrency} ${riskAmount.toFixed(2)}`;
            document.getElementById("lotSizeResult").textContent = lotSize.toFixed(2);
            document.getElementById("microLotsResult").textContent = (lotSize * 100).toFixed(2);
            document.getElementById("pipValueResult").textContent = `${accountCurrency} ${(pipValue/100).toFixed(2)} per pip`;
        }
        
        // Calculate pips and profit
        function calculatePipsAndProfit(params) {
            const { pair, entryPrice, exitPrice, lotSize, direction, outcome, currency } = params;
            
            let pips = 0;
            let profit = 0;
            const pipValue = calculatePipValue(pair, currency);
            
            // Gold calculation
            if (pair === "XAU/USD") {
                if (direction === "buy") {
                    pips = (exitPrice - entryPrice) * 100; // Convert $1.23 to 123 pips
                } else {
                    pips = (entryPrice - exitPrice) * 100;
                }
                profit = pips * pipValue * lotSize;
            }
            // Crypto calculation
            else if (pair === "BTC/USD" || pair === "ETH/USD") {
                if (direction === "buy") {
                    pips = exitPrice - entryPrice;
                } else {
                    pips = entryPrice - exitPrice;
                }
                profit = pips * pipValue * lotSize;
            }
            // JPY pairs calculation
            else if (pair.includes("JPY")) {
                if (direction === "buy") {
                    pips = (exitPrice - entryPrice) * 100;
                } else {
                    pips = (entryPrice - exitPrice) * 100;
                }
                profit = (pips * pipValue * lotSize) / 100;
            }
            // Standard forex calculation
            else {
                if (direction === "buy") {
                    pips = (exitPrice - entryPrice) * 10000;
                } else {
                    pips = (entryPrice - exitPrice) * 10000;
                }
                profit = (pips * pipValue * lotSize) / 100;
            }
            
            // If it's a loss, make profit negative
            if ((pips < 0 && outcome === "win") || (pips > 0 && outcome === "loss")) {
                profit = -Math.abs(profit);
                pips = Math.abs(pips);
            } else {
                pips = Math.abs(pips);
            }
            
            return { pips, profit };
        }
        
        // Record a trade
        function recordTrade(outcome) {
            // Get selected pair
            const pairSelect = document.getElementById("modalTradePair");
            let pair = pairSelect.value;
            
            // Check if custom pair is selected
            if (pair === "custom") {
                pair = document.getElementById("customPair").value;
                if (!pair) {
                    alert("Please enter a custom pair!");
                    return;
                }
            }
            
            // Get other inputs
            const entryPrice = parseFloat(document.getElementById("modalEntryPrice").value);
            const exitPrice = parseFloat(document.getElementById("modalExitPrice").value);
            const lotSize = parseFloat(document.getElementById("modalTradeLotSize").value);
            const direction = document.querySelector('input[name="tradeDirection"]:checked').value;
            const currency = document.getElementById("modalTradeCurrency").value;
            
            // Validate inputs
            if (!pair || !entryPrice || !exitPrice || !lotSize) {
                alert("Please fill in all trade details!");
                return;
            }
            
            // Calculate P&L
            const { pips, profit } = calculatePipsAndProfit({
                pair,
                entryPrice,
                exitPrice,
                lotSize,
                direction,
                outcome,
                currency
            });
            
            // Create trade object
            const trade = {
                id: Date.now(),
                date: new Date().toISOString(),
                pair,
                entryPrice,
                exitPrice,
                lotSize,
                direction,
                outcome,
                pips: pips.toFixed(1),
                profit: profit.toFixed(2),
                currency
            };
            
            // Add to trades array
            trades.push(trade);
            
            // Save to localStorage
            localStorage.setItem('trades', JSON.stringify(trades));
            
            // Update UI
            updateTradeHistory();
            updateStatistics();
            
            // Hide modal
            hideRecordTradeModal();
        }
        
        // Delete a trade
        function deleteTrade(id) {
            if (confirm("Are you sure you want to delete this trade?")) {
                trades = trades.filter(trade => trade.id !== id);
                localStorage.setItem('trades', JSON.stringify(trades));
                updateTradeHistory();
                updateStatistics();
            }
        }
        
        // Format currency
        function formatCurrency(amount, currency = "USD") {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: currency,
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }
        
        // Format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return new Intl.DateTimeFormat('en-US', {
                month: 'short',
                day: 'numeric',
                year: 'numeric'
            }).format(date);
        }
        
        // Get badge class for pair
        function getPairBadgeClass(pair) {
            if (pair.includes("XAU")) return "badge badge-gold";
            if (pair.includes("BTC") || pair.includes("ETH")) return "badge badge-crypto";
            return "badge badge-forex";
        }
        
        // Update trade history display
        function updateTradeHistory() {
            const tableBody = document.getElementById("tradeHistoryBody");
            const emptyState = document.getElementById("emptyTradeHistory");
            const table = document.getElementById("tradeHistoryTable");
            
            // Check if there are trades
            if (trades.length === 0) {
                emptyState.style.display = "block";
                table.style.display = "none";
                return;
            }
            
            // Show table, hide empty state
            emptyState.style.display = "none";
            table.style.display = "table";
            
            // Clear table body
            tableBody.innerHTML = "";
            
            // Add trades to table
            trades.slice().reverse().forEach(trade => {
                const row = document.createElement("tr");
                
                row.innerHTML = `
                    <td>${formatDate(trade.date)}</td>
                    <td><span class="${getPairBadgeClass(trade.pair)}">${trade.pair}</span></td>
                    <td><span class="badge badge-${trade.direction === 'buy' ? 'buy' : 'sell'}">${trade.direction.toUpperCase()}</span></td>
                    <td>${trade.entryPrice}</td>
                    <td>${trade.exitPrice}</td>
                    <td>${trade.lotSize}</td>
                    <td>${trade.pips}</td>
                    <td class="${trade.outcome === 'win' ? 'change-positive' : 'change-negative'}">${formatCurrency(Number(trade.profit), trade.currency)}</td>
                    <td>
                        <button class="button button-outline" style="padding: 5px; min-width: 30px;" onclick="deleteTrade(${trade.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Update statistics
            updateStats();
        }
        
        // Update basic statistics
        function updateStats() {
            if (trades.length === 0) {
                document.getElementById("winRate").textContent = "0%";
                document.getElementById("lossRate").textContent = "0%";
                document.getElementById("totalTrades").textContent = "0";
                document.getElementById("netPL").textContent = "$0.00";
                document.getElementById("netPL").className = "stat-value";
                document.getElementById("netPLIcon").className = "stat-icon";
                return;
            }
            
            const wins = trades.filter(trade => trade.outcome === 'win').length;
            const losses = trades.filter(trade => trade.outcome === 'loss').length;
            
            const winRate = Math.round((wins / trades.length) * 100);
            const lossRate = Math.round((losses / trades.length) * 100);
            
            // Calculate profit/loss
            const totalProfit = trades
                .filter(trade => trade.outcome === 'win')
                .reduce((sum, trade) => sum + Number(trade.profit), 0);
                
            const totalLoss = trades
                .filter(trade => trade.outcome === 'loss')
                .reduce((sum, trade) => sum + Math.abs(Number(trade.profit)), 0);
                
            const netProfitLoss = totalProfit - totalLoss;
            
            // Get most common currency
            const currencyMap = trades.reduce((acc, trade) => {
                acc[trade.currency] = (acc[trade.currency] || 0) + 1;
                return acc;
            }, {});
            
            const mostCommonCurrency = Object.entries(currencyMap).sort((a, b) => b[1] - a[1])[0]?.[0] || "USD";
            
            document.getElementById("winRate").textContent = `${winRate}%`;
            document.getElementById("lossRate").textContent = `${lossRate}%`;
            document.getElementById("totalTrades").textContent = trades.length;
            document.getElementById("netPL").textContent = formatCurrency(netProfitLoss, mostCommonCurrency);
            
            // Update net P/L color
            if (netProfitLoss >= 0) {
                document.getElementById("netPL").className = "stat-value positive";
                document.getElementById("netPLIcon").className = "stat-icon positive";
            } else {
                document.getElementById("netPL").className = "stat-value negative";
                document.getElementById("netPLIcon").className = "stat-icon negative";
            }
        }
        
        // Update detailed statistics
        function updateStatistics() {
            const timeframe = document.getElementById("statsTimeframe").value;
            
            // Filter trades based on timeframe
            const filteredTrades = filterTradesByTimeframe(trades, timeframe);
            
            // Update pairs performance
            updatePairsPerformance(filteredTrades);
            
            // Update profit analysis
            updateProfitAnalysis(filteredTrades);
        }
        
        // Filter trades by timeframe
        function filterTradesByTimeframe(trades, timeframe) {
            if (timeframe === "all") return trades;
            
            const now = new Date();
            const startDate = new Date();
            
            if (timeframe === "week") {
                startDate.setDate(now.getDate() - 7);
            } else if (timeframe === "month") {
                startDate.setMonth(now.getMonth() - 1);
            } else if (timeframe === "year") {
                startDate.setFullYear(now.getFullYear() - 1);
            }
            
            return trades.filter(trade => new Date(trade.date) >= startDate);
        }
        
        // Update pairs performance
        function updatePairsPerformance(filteredTrades) {
            const tableBody = document.getElementById("pairsStatsBody");
            const emptyState = document.getElementById("emptyPairsStats");
            const table = document.getElementById("pairsStatsTable");
            
            // Check if there are trades
            if (filteredTrades.length === 0) {
                emptyState.style.display = "block";
                table.style.display = "none";
                return;
            }
            
            // Show table, hide empty state
            emptyState.style.display = "none";
            table.style.display = "table";
            
            // Clear table body
            tableBody.innerHTML = "";
            
            // Calculate pair statistics
            const pairStats = filteredTrades.reduce((acc, trade) => {
                if (!acc[trade.pair]) {
                    acc[trade.pair] = {
                        total: 0,
                        wins: 0,
                        losses: 0,
                        profit: 0,
                        loss: 0,
                        currency: trade.currency
                    };
                }
                
                acc[trade.pair].total += 1;
                
                if (trade.outcome === "win") {
                    acc[trade.pair].wins += 1;
                    acc[trade.pair].profit += Number(trade.profit);
                } else {
                    acc[trade.pair].losses += 1;
                    acc[trade.pair].loss += Math.abs(Number(trade.profit));
                }
                
                return acc;
            }, {});
            
            // Sort pairs by total trades
            const sortedPairs = Object.entries(pairStats).sort((a, b) => b[1].total - a[1].total);
            
            // Add pairs to table
            sortedPairs.forEach(([pair, stats]) => {
                const row = document.createElement("tr");
                const winRate = (stats.wins / stats.total) * 100;
                const netPL = stats.profit - stats.loss;
                
                row.innerHTML = `
                    <td><span class="${getPairBadgeClass(pair)}">${pair}</span></td>
                    <td style="text-align: center;">${stats.total}</td>
                    <td style="text-align: center;" class="${winRate >= 50 ? 'change-positive' : 'change-negative'}">${winRate.toFixed(1)}%</td>
                    <td style="text-align: right;" class="${netPL >= 0 ? 'change-positive' : 'change-negative'}">${formatCurrency(netPL, stats.currency)}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }
        
        // Update profit analysis
        function updateProfitAnalysis(filteredTrades) {
            if (filteredTrades.length === 0) {
                document.getElementById("totalProfit").textContent = "$0.00";
                document.getElementById("totalLoss").textContent = "$0.00";
                document.getElementById("netProfit").textContent = "$0.00";
                document.getElementById("profitFactor").textContent = "N/A";
                document.getElementById("avgWin").textContent = "$0.00";
                document.getElementById("avgLoss").textContent = "$0.00";
                document.getElementById("largestWin").textContent = "$0.00";
                document.getElementById("largestLoss").textContent = "$0.00";
                return;
            }
            
            // Calculate profit/loss
            const winTrades = filteredTrades.filter(trade => trade.outcome === 'win');
            const lossTrades = filteredTrades.filter(trade => trade.outcome === 'loss');
            
            const totalProfit = winTrades.reduce((sum, trade) => sum + Number(trade.profit), 0);
            const totalLoss = lossTrades.reduce((sum, trade) => sum + Math.abs(Number(trade.profit)), 0);
            const netProfitLoss = totalProfit - totalLoss;
            
            // Get most common currency
            const currencyMap = filteredTrades.reduce((acc, trade) => {
                acc[trade.currency] = (acc[trade.currency] || 0) + 1;
                return acc;
            }, {});
            
            const mostCommonCurrency = Object.entries(currencyMap).sort((a, b) => b[1] - a[1])[0]?.[0] || "USD";
            
            // Calculate other statistics
            const profitFactor = totalLoss > 0 ? totalProfit / totalLoss : "N/A";
            const avgWin = winTrades.length > 0 ? totalProfit / winTrades.length : 0;
            const avgLoss = lossTrades.length > 0 ? totalLoss / lossTrades.length : 0;
            
            const largestWin = winTrades.length > 0 
                ? Math.max(...winTrades.map(t => Number(t.profit)))
                : 0;
                
            const largestLoss = lossTrades.length > 0 
                ? Math.max(...lossTrades.map(t => Math.abs(Number(t.profit))))
                : 0;
            
            // Update UI
            document.getElementById("totalProfit").textContent = formatCurrency(totalProfit, mostCommonCurrency);
            document.getElementById("totalLoss").textContent = formatCurrency(totalLoss, mostCommonCurrency);
            document.getElementById("netProfit").textContent = formatCurrency(netProfitLoss, mostCommonCurrency);
            document.getElementById("netProfit").className = "stats-item-value " + (netProfitLoss >= 0 ? "change-positive" : "change-negative");
            
            document.getElementById("profitFactor").textContent = typeof profitFactor === "number" ? profitFactor.toFixed(2) : profitFactor;
            document.getElementById("avgWin").textContent = formatCurrency(avgWin, mostCommonCurrency);
            document.getElementById("avgLoss").textContent = formatCurrency(avgLoss, mostCommonCurrency);
            document.getElementById("largestWin").textContent = formatCurrency(largestWin, mostCommonCurrency);
            document.getElementById("largestLoss").textContent = formatCurrency(largestLoss, mostCommonCurrency);
        }
        
        // Load market data
        function loadMarketData() {
            // Show loading state
            document.getElementById("refreshButton").innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
            
            // Simulate API call with mock data
            setTimeout(() => {
                // Mock market data
                marketData = [
                    {
                        symbol: "EUR/USD",
                        bid: 1.0876,
                        ask: 1.0878,
                        change: 0.0023,
                        changePercent: 0.21,
                        high: 1.0892,
                        low: 1.0845,
                        type: "forex",
                    },
                    {
                        symbol: "GBP/USD",
                        bid: 1.2654,
                        ask: 1.2657,
                        change: -0.0045,
                        changePercent: -0.35,
                        high: 1.271,
                        low: 1.264,
                        type: "forex",
                    },
                    {
                        symbol: "USD/JPY",
                        bid: 149.32,
                        ask: 149.35,
                        change: 0.75,
                        changePercent: 0.5,
                        high: 149.85,
                        low: 148.6,
                        type: "forex",
                    },
                    {
                        symbol: "AUD/USD",
                        bid: 0.6543,
                        ask: 0.6545,
                        change: -0.0032,
                        changePercent: -0.49,
                        high: 0.658,
                        low: 0.653,
                        type: "forex",
                    },
                    {
                        symbol: "USD/CAD",
                        bid: 1.3654,
                        ask: 1.3657,
                        change: 0.0078,
                        changePercent: 0.57,
                        high: 1.367,
                        low: 1.358,
                        type: "forex",
                    },
                    {
                        symbol: "XAU/USD",
                        bid: 2324.5,
                        ask: 2325.2,
                        change: 12.75,
                        changePercent: 0.55,
                        high: 2330.0,
                        low: 2310.25,
                        type: "gold",
                    },
                    {
                        symbol: "BTC/USD",
                        bid: 63245.8,
                        ask: 63275.5,
                        change: 1250.3,
                        changePercent: 2.01,
                        high: 63500.0,
                        low: 61800.0,
                        type: "crypto",
                    },
                    {
                        symbol: "ETH/USD",
                        bid: 3045.75,
                        ask: 3048.25,
                        change: 85.5,
                        changePercent: 2.89,
                        high: 3060.0,
                        low: 2950.0,
                        type: "crypto",
                    },
                ];
                
                // Update market data display
                updateMarketDisplay();
                
                // Update last updated time
                const now = new Date();
                document.getElementById("marketLastUpdated").textContent = `Last updated: ${now.toLocaleTimeString()}`;
                
                // Reset refresh button
                document.getElementById("refreshButton").innerHTML = '<i class="fas fa-sync-alt"></i> Refresh';
            }, 1000);
        }
        
        // Refresh market data
        function refreshMarketData() {
            // Show loading state
            document.getElementById("refreshButton").innerHTML = '<i class="fas fa-spinner fa-spin"></i> Refreshing...';
            
            // Simulate API call with updated mock data
            setTimeout(() => {
                // Update with slightly different values to simulate market movement
                marketData = marketData.map(item => ({
                    ...item,
                    bid: Number((item.bid + (Math.random() * 0.01 - 0.005)).toFixed(
                        item.type === "forex" ? 4 : item.type === "gold" ? 2 : 2
                    )),
                    ask: Number((item.ask + (Math.random() * 0.01 - 0.005)).toFixed(
                        item.type === "forex" ? 4 : item.type === "gold" ? 2 : 2
                    )),
                    change: Number((item.change + (Math.random() * 0.02 - 0.01)).toFixed(4)),
                    changePercent: Number((item.changePercent + (Math.random() * 0.1 - 0.05)).toFixed(2)),
                }));
                
                // Update market data display
                updateMarketDisplay();
                
                // Update last updated time
                const now = new Date();
                document.getElementById("marketLastUpdated").textContent = `Last updated: ${now.toLocaleTimeString()}`;
                
                // Reset refresh button
                document.getElementById("refreshButton").innerHTML = '<i class="fas fa-sync-alt"></i> Refresh';
            }, 1000);
        }
        
        // Update market display
        function updateMarketDisplay() {
            // Update forex market
            updateMarketTable("forexMarketBody", "forex");
            
            // Update gold market
            updateMarketTable("goldMarketBody", "gold");
            
            // Update crypto market
            updateMarketTable("cryptoMarketBody", "crypto");
        }
        
        // Update market table
        function updateMarketTable(tableId, type) {
            const tableBody = document.getElementById(tableId);
            tableBody.innerHTML = "";
            
            // Filter market data by type
            const filteredData = marketData.filter(item => item.type === type);
            
            // Add market data to table
            filteredData.forEach(item => {
                const row = document.createElement("tr");
                
                // Format price based on type
                const priceFormat = item.type === "forex" ? 4 : 2;
                
                row.innerHTML = `
                    <td><span class="${getPairBadgeClass(item.symbol)}">${item.symbol}</span></td>
                    <td style="text-align: right;">${item.bid.toFixed(priceFormat)}</td>
                    <td style="text-align: right;">${item.ask.toFixed(priceFormat)}</td>
                    <td style="text-align: right;">
                        <div style="display: flex; align-items: center; justify-content: flex-end; gap: 5px;">
                            <span class="${item.change >= 0 ? 'change-positive' : 'change-negative'}">
                                ${item.change >= 0 ? '+' : ''}${item.change.toFixed(priceFormat)}
                            </span>
                            <span class="${item.change >= 0 ? 'change-positive' : 'change-negative'}">
                                (${item.change >= 0 ? '+' : ''}${item.changePercent.toFixed(2)}%)
                            </span>
                            <i class="fas fa-${item.change >= 0 ? 'arrow-up' : 'arrow-down'} ${item.change >= 0 ? 'change-positive' : 'change-negative'}"></i>
                        </div>
                    </td>
                    <td style="text-align: right;">${item.high.toFixed(priceFormat)}</td>
                    <td style="text-align: right;">${item.low.toFixed(priceFormat)}</td>
                `;
                
                tableBody.appendChild(row);
            });
        }
    </script>
</body>
</html>
